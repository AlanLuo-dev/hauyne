<nz-drawer
    [nzBodyStyle]="{ overflow: 'auto' }"
    [nzMaskClosable]="false"
    [nzWidth]="'50%'"
    [(nzVisible)]="auditDisplay"
    [nzTitle]="'ÂÆ°ËÆ°Êó•Âøó'"
    (nzOnClose)="closeAuditDialog()"
    [nzKeyboard]="false"
    [nzMask]="true"
>
    <ng-container *nzDrawerContent>
        <!-- Âä†ËΩΩ‰∏≠ Âä®Áîª -->
        <nz-spin [nzSpinning]="isLoadingAudit" nzTip="Âä†ËΩΩ‰∏≠...">

            <!-- Tabs START -->
            <nz-tabs [nzSelectedIndex]="selectedTabIndex">
                @for (entry of typeRemarkEntries; track entry[0]; let i = $index) {
                    <nz-tab [nzTitle]="nzTabLabel">

                        <!-- Ê†áÁ≠æÁöÑÊ†áÈ¢ò START -->
                        <ng-template #nzTabLabel>
                            {{ entry[1] }}
                            @if (entry[0] === latestTypeName) {
                                <nz-badge nzDot nz-tooltip nzTooltipTitle="ÊúÄÊñ∞"></nz-badge>
                            }
                        </ng-template>
                        <!-- Ê†áÁ≠æÁöÑÊ†áÈ¢ò END -->

                        <!-- Êó∂Èó¥ËΩ¥ START -->
                        <nz-timeline>
                            @for (change of getGroupChanges(entry[0]); track change.version) {
                                <nz-timeline-item [nzDot]="dotTemplate">
                                    <h4 class="version-title">ÁâàÊú¨ #{{ change.version }}</h4>
                                    <div class="audit-meta">
                                        <span class="time">{{ change.commitDate }}</span>
                                        <span class="author">üë§ ‰ΩúËÄÖÔºö{{ change.author }}</span>
                                        <span [class]="'type type-' + change.changeType.toLowerCase()"
                                        >üõ†Ô∏è ÂèòÊõ¥Á±ªÂûãÔºö{{ change.changeType }}</span>
                                    </div>
                                    @for (field of change.changes; track field.property) {
                                        <div class="audit-field">
                                            <nz-tag [nzColor]="'#1890ff'">{{ field.label }}</nz-tag>
                                            <span class="old">ÊóßÂÄºÔºö{{ field.oldValue || 'Á©∫' }}</span>
                                            ‚Üí
                                            <span class="new">Êñ∞ÂÄºÔºö{{ field.newValue || 'Á©∫' }}</span>
                                        </div>
                                    }
                                </nz-timeline-item>
                            }
                        </nz-timeline>
                        <!-- Êó∂Èó¥ËΩ¥ END -->
                    </nz-tab>
                }
            </nz-tabs>
            <!-- Tabs END -->
        </nz-spin>

        <ng-template #dotTemplate>
            <nz-icon nzType="clock-circle" nzTheme="twotone" nzTwotoneColor="#52c41a" style="font-size: 16px;"/>
        </ng-template>
    </ng-container>


</nz-drawer>
