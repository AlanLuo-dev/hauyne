<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.luoyx.hauyne.toolbox.codegen.mapper.DataSourceMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.luoyx.hauyne.toolbox.codegen.entity.DataSource">
        <id column="id" property="id" />
        <result column="datasource_name" property="dataSourceName" />
        <result column="driver_class_name" property="driverClassName" />
        <result column="url" property="url" />
        <result column="username" property="username" />
        <result column="password" property="password" />
        <result column="created_by" property="createdBy" />
        <result column="created_time" property="createdTime" />
        <result column="last_updated_by" property="lastUpdatedBy" />
        <result column="last_updated_time" property="lastUpdatedTime" />
    </resultMap>

    <select id="pageList" parameterType="com.luoyx.hauyne.toolbox.codegen.query.DataSourceQuery" resultType="com.luoyx.hauyne.toolbox.codegen.vo.response.DataSourcePageResultVO">
        SELECT
            ds.id as id,
            ds.data_source_name,
            ds.driver_class_name,
            ds.url,
            ds.username,
            ds.`password`,
            c.username as created_by,
            ds.created_time as createdTime ,
            u.username as last_updated_by,
            ds.last_updated_time as lastUpdatedTime
        FROM
            hyn_codegen_data_source ds
            left join hyn_sys_user c on ds.created_by = c.id
            left join hyn_sys_user u on ds.last_updated_by = u.id
        <where>

            <!-- 数据源名称 -->
            <if test="dataSourceName != null and dataSourceName != ''">
                <bind name="pattern_data_source_name" value="'%' + dataSourceName + '%'"/>
                ds.data_source_name like #{pattern_data_source_name}
            </if>

            <!-- 创建人id -->
            <if test="createdBy != null">
                and ds.created_by = #{createdBy}
            </if>
        </where>
    </select>
</mapper>
